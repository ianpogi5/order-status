service: order-status

plugins:
  - serverless-bundle
  - serverless-offline

package:
  individually: true

custom:
  serverless-offline:
    httpPort: 8000
    websocketPort: 9000
    noPrependStageInUrl: true
    useChildProcesses: true

provider:
  name: aws
  runtime: nodejs12.x
  memorySize: 256
  timeout: 30
  profile: ${file(../config.yml):PROFILE}
  region: ${file(../config.yml):REGION}
  environment:
    AWS_REGION: ${file(../config.yml):REGION}
    WS_ENDPOINT: ${file(../config.yml):WS_ENDPOINT}
    DDB_ENDPOINT: ${file(../config.yml):DDB_ENDPOINT}
    WS_TABLE_NAME: ${file(../config.yml):WS_TABLE_NAME}
    ORDER_TABLE_NAME: ${file(../config.yml):ORDER_TABLE_NAME}

functions:
  websocket-connect:
    handler: src/connect.handler
    events:
      - websocket:
          route: $connect
  websocket-disconnect:
    handler: src/disconnect.handler
    events:
      - websocket:
          route: $disconnect
  websocket-default:
    handler: src/default.handler
    events:
      - websocket:
          route: $default
  websocket-message:
    handler: src/message.handler
    events:
      - websocket:
          route: message
